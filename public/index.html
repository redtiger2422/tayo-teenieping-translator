<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì˜ ë§ˆë²• ë²ˆì—­ê¸°</title>
  <style>
    /* ë””ìì¸ CSSëŠ” ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤. */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(120deg, #a1e0ff 40%, #f9e0ff 100%);
      box-sizing: border-box;
      font-family: 'Spoqa Han Sans Neo', 'Noto Sans KR', Arial, sans-serif;
    }
    
    body {
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
    }
    
    #translatorContainer {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      z-index: 2;
    }
    
    #translatorBox {
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      box-shadow: 0 6px 40px rgba(20,60,160,0.17);
      padding: 40px 30px;
      max-width: 800px;
      width: 90vw;
      margin: 0 auto;
      position: relative;
      text-align: center;
    }
    
    #logoSection {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .character-img {
      width: 70px;
      height: 70px;
      object-fit: contain;
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.9);
      padding: 8px;
      box-shadow: 0 4px 20px rgba(30,70,180,0.15);
      animation: float 3s ease-in-out infinite;
      transition: transform 0.3s ease;
    }
    
    .character-img:hover {
      transform: scale(1.1);
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    .logo-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(45deg, #66b5f6, #3d97e0);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: white;
      box-shadow: 0 3px 15px rgba(30,70,180,0.11);
    }
    
    #titleSection {
      margin-bottom: 30px;
    }
    
    #titleSection h1 {
      color: #3186eb;
      font-size: 2.2em;
      font-weight: bold;
      margin: 0 0 10px 0;
      text-shadow: 0 1px 5px rgba(255,255,255,0.4);
    }
    
    #titleSection p {
      color: #6864e2;
      font-size: 1.1em;
      margin: 0;
      opacity: 0.8;
    }
    
    #translationSection {
      margin-bottom: 30px;
      opacity: 1;
      pointer-events: auto;
    }
    
    .language-selector {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 25px;
    }
    
    .lang-btn {
      background: rgba(255,255,255,0.7);
      color: #3677b6;
      border: 2px solid #aad3fd;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1.1em;
      font-weight: bold;
      transition: all 0.3s ease;
      font-family: inherit;
    }
    
    .lang-btn:hover {
      background: rgba(102, 181, 246, 0.1);
      border-color: #66b5f6;
    }
    
    .lang-btn.active {
      background: linear-gradient(45deg, #66b5f6, #3d97e0);
      color: white;
      border-color: #66b5f6;
      box-shadow: 0 2px 10px rgba(102, 181, 246, 0.3);
    }
    
    .translation-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .translation-box {
      flex: 1;
      min-width: 250px;
      position: relative;
    }
    
    .translation-box h3 {
      color: #3677b6;
      margin: 0 0 10px 0;
      font-size: 1.3em;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .translation-box textarea {
      width: 100%;
      height: 120px;
      padding: 15px;
      border: 2px solid #aad3fd;
      border-radius: 10px;
      font-size: 1.1em;
      background: #f5fbff;
      resize: vertical;
      box-sizing: border-box;
      font-family: inherit;
    }
    
    .translation-box textarea:focus {
      outline: none;
      border-color: #66b5f6;
      box-shadow: 0 0 10px rgba(102, 181, 246, 0.3);
    }
    
    #outputText {
      background: #fff;
      border-color: #d4edda;
      color: #155724;
    }
    
    #translateBtn {
      background: linear-gradient(45deg, #66b5f6, #3d97e0);
      color: white;
      font-weight: bold;
      padding: 12px 40px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1.2em;
      box-shadow: 0 4px 15px rgba(102, 181, 246, 0.4);
      transition: all 0.3s ease;
      margin: 20px 0;
      position: relative;
    }
    
    #translateBtn:hover {
      background: linear-gradient(45deg, #5aa3f0, #2976cc);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 181, 246, 0.6);
    }
    
    #translateBtn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    #status {
      margin-top: 15px;
      padding: 10px;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      min-height: 20px;
      transition: all 0.3s ease;
      display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ ì²˜ë¦¬ */
    }
    
    #status.success {
      display: block;
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    #status.error {
      display: block;
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    #status.info {
      display: block;
      background: #cce7ff;
      color: #004085;
      border: 1px solid #b8daff;
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 30px;
    }
    
    .feature-box {
      background: rgba(255,255,255,0.7);
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      border: 1px solid #e3f2fd;
    }
    
    .feature-box h4 {
      color: #3677b6;
      margin: 0 0 10px 0;
      font-size: 1.1em;
    }
    
    .feature-box p {
      color: #666;
      margin: 0;
      font-size: 0.9em;
    }
    
    #madeBy {
      font-size: 0.9em;
      color: #aaa;
      margin-top: 30px;
      text-align: center;
    }
    
    #musicBtn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(45deg, #66b5f6, #3d97e0);
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.5em;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(102, 181, 246, 0.4);
      transition: all 0.3s ease;
      z-index: 1000;
    }
    
    #musicBtn:hover {
      background: linear-gradient(45deg, #5aa3f0, #2976cc);
      transform: scale(1.1);
    }
    
    @media (max-width: 768px) {
      #translatorBox {
        padding: 20px 15px;
      }
      #titleSection h1 {
        font-size: 1.8em;
      }
      .translation-container {
        flex-direction: column;
        gap: 15px;
      }
      .translation-box {
        min-width: auto;
      }
      .translation-box textarea {
        height: 100px;
      }
      .features {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <button id="musicBtn" title="ë°°ê²½ìŒì•… ì¬ìƒ/ì¼ì‹œì •ì§€">ğŸµ</button>
  
  <audio id="bgMusic" loop>
    <source src="tayo1.mp3" type="audio/mpeg">
    ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  </audio>
  
  <div id="translatorContainer">
    <div id="translatorBox">
      <div id="logoSection">
        <img src="íƒ€ìš”ìë™ì°¨.png" alt="íƒ€ìš”" class="character-img">
        <div class="logo-icon">ğŸŒ</div>
        <div class="logo-icon">ğŸ’¬</div>
        <div class="logo-icon">ğŸ”¤</div>
        <img src="í‹°ë‹ˆí•‘ê³µì£¼.png" alt="í‹°ë‹ˆí•‘" class="character-img">
      </div>
      
      <div id="titleSection">
        <h1>âœ¨ íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì˜ ë§ˆë²• ë²ˆì—­ê¸° âœ¨</h1>
        <p>ğŸšŒ íƒ€ìš”ì™€ ğŸ‘‘ í‹°ë‹ˆí•‘ì´ ë„ì™€ì£¼ëŠ” ì¬ë¯¸ìˆëŠ” ë²ˆì—­ ë†€ì´! ğŸ‰</p>
      </div>
      
      <div id="translationSection">
        <div class="language-selector">
          <button id="korToEngBtn" class="lang-btn active">í•œêµ­ì–´ â†’ ì˜ì–´</button>
          <button id="engToKorBtn" class="lang-btn">ì˜ì–´ â†’ í•œêµ­ì–´</button>
        </div>
        
        <div class="translation-container">
          <div class="translation-box">
            <h3 id="inputLangTitle">ğŸ‡°ğŸ‡· í•œêµ­ì–´ ì…ë ¥</h3>
            <textarea id="inputText" placeholder="íƒ€ìš”ì™€ í•¨ê»˜ í•œêµ­ì–´ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”! ğŸšŒ"></textarea>
          </div>
          
          <div class="translation-box">
            <h3 id="outputLangTitle">ğŸ‡ºğŸ‡¸ ì˜ì–´ ë²ˆì—­</h3>
            <textarea id="outputText" placeholder="í‹°ë‹ˆí•‘ì´ ì˜ì–´ë¡œ ë²ˆì—­í•´ì¤„ê²Œìš”! ğŸ‘‘" readonly></textarea>
          </div>
        </div>
        
        <button id="translateBtn">ë²ˆì—­í•˜ê¸°</button>
        
        <div id="status"></div>
      </div>
      
      <div class="features">
        <div class="feature-box">
          <h4>ğŸš€ ë§ˆë²•ê°™ì€ ë²ˆì—­</h4>
          <p>íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì˜ ë„ì›€ìœ¼ë¡œ ë¹ ë¥¸ ë²ˆì—­</p>
        </div>
        
        <div class="feature-box">
          <h4>ğŸ® ì¬ë¯¸ìˆëŠ” í•™ìŠµ</h4>
          <p>ë†€ì´í•˜ë“¯ ì–¸ì–´ë¥¼ ë°°ì›Œë³´ì„¸ìš”</p>
        </div>
        
        <div class="feature-box">
          <h4>ğŸ” ì™„ì „ ë³´ì•ˆ</h4>
          <p>ì„œë²„ì—ì„œ ì•ˆì „í•˜ê²Œ API í‚¤ ê´€ë¦¬</p>
        </div>
      </div>
      
      <div id="madeBy">Made by ì í˜¸ì•½ì‚¬</div>
    </div>
  </div>
  
  <script>
    // --- ìµœì¢… ìˆ˜ì •ëœ ìŠ¤í¬ë¦½íŠ¸ ---

    class KoreanEnglishTranslator {
      constructor() {
        this.currentMode = 'korToEng';
        this.musicPlaying = false;
        this.initializeElements();
        this.bindEvents();
        this.initializeMusic();
      }
      
      initializeElements() {
        this.inputText = document.getElementById('inputText');
        this.outputText = document.getElementById('outputText');
        this.translateBtn = document.getElementById('translateBtn');
        this.status = document.getElementById('status');
        this.korToEngBtn = document.getElementById('korToEngBtn');
        this.engToKorBtn = document.getElementById('engToKorBtn');
        this.inputLangTitle = document.getElementById('inputLangTitle');
        this.outputLangTitle = document.getElementById('outputLangTitle');
        this.musicBtn = document.getElementById('musicBtn');
        this.bgMusic = document.getElementById('bgMusic');
      }
      
      bindEvents() {
        this.translateBtn.addEventListener('click', () => this.translateText());
        this.korToEngBtn.addEventListener('click', () => this.switchMode('korToEng'));
        this.engToKorBtn.addEventListener('click', () => this.switchMode('engToKor'));
        this.musicBtn.addEventListener('click', () => this.toggleMusic());
      }
      
      switchMode(mode) {
        this.currentMode = mode;
        this.updateLanguageDisplay();
        this.clearTexts();
      }
      
      updateLanguageDisplay() {
        if (this.currentMode === 'korToEng') {
          this.korToEngBtn.classList.add('active');
          this.engToKorBtn.classList.remove('active');
          this.inputLangTitle.innerHTML = 'ğŸ‡°ğŸ‡· í•œêµ­ì–´ ì…ë ¥';
          this.outputLangTitle.innerHTML = 'ğŸ‡ºğŸ‡¸ ì˜ì–´ ë²ˆì—­';
          this.inputText.placeholder = 'íƒ€ìš”ì™€ í•¨ê»˜ í•œêµ­ì–´ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”! ğŸšŒ';
          this.outputText.placeholder = 'í‹°ë‹ˆí•‘ì´ ì˜ì–´ë¡œ ë²ˆì—­í•´ì¤„ê²Œìš”! ğŸ‘‘';
        } else {
          this.korToEngBtn.classList.remove('active');
          this.engToKorBtn.classList.add('active');
          this.inputLangTitle.innerHTML = 'ğŸ‡ºğŸ‡¸ ì˜ì–´ ì…ë ¥';
          this.outputLangTitle.innerHTML = 'ğŸ‡°ğŸ‡· í•œêµ­ì–´ ë²ˆì—­';
          this.inputText.placeholder = 'í‹°ë‹ˆí•‘ê³¼ í•¨ê»˜ ì˜ì–´ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”! ğŸ‘‘';
          this.outputText.placeholder = 'íƒ€ìš”ê°€ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ì¤„ê²Œìš”! ğŸšŒ';
        }
      }
      
      clearTexts() {
        this.inputText.value = '';
        this.outputText.value = '';
        this.showStatus('', ''); // ìƒíƒœ ë©”ì‹œì§€ ì´ˆê¸°í™”
      }
      
      showStatus(message, type = '') {
        this.status.textContent = message;
        this.status.className = type; // í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì„¤ì •í•˜ì—¬ CSS ì ìš©
      }
      
      async translateText() {
        const text = this.inputText.value.trim();
        
        if (!text) {
          this.showStatus('ë²ˆì—­í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'error');
          return;
        }
        
        this.translateBtn.disabled = true;
        this.outputText.value = '';
        this.showStatus('íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì´ ë²ˆì—­ ì¤‘ì´ì—ìš”... ğŸšŒğŸ‘‘', 'info');
        
        try {
          const response = await fetch('/translate', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              text: text,
              mode: this.currentMode // ì„œë²„ì™€ ì•½ì†ëœ 'mode'ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
            })
          });
          
          const data = await response.json(); // ì„œë²„ë¡œë¶€í„° ì‘ë‹µì„ JSONìœ¼ë¡œ íŒŒì‹±í•©ë‹ˆë‹¤.

          if (!response.ok) {
            // HTTP ìƒíƒœ ì½”ë“œê°€ 200-299 ë²”ìœ„ê°€ ì•„ë‹ ê²½ìš° (ì„œë²„ ìì²´ ì—ëŸ¬ ë“±)
            // ì„œë²„ê°€ ë³´ë‚¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
            throw new Error(data.error || `ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
          }
          
          // ì„œë²„ì™€ ì•½ì†ëœ 'success' í‚¤ë¡œ ì„±ê³µ ì—¬ë¶€ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤.
          if (data.success) {
            // ì„œë²„ì™€ ì•½ì†ëœ 'translation' í‚¤ë¡œ ë²ˆì—­ ê²°ê³¼ë¥¼ ë°›ìŠµë‹ˆë‹¤.
            this.outputText.value = data.translation; 
            this.showStatus('ì™€! ë²ˆì—­ ì™„ë£Œ! íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì´ ë„ì™€ì¤¬ì–´ìš”! ğŸ‰', 'success');
          } else {
            // successê°€ falseì¼ ê²½ìš°, ì„œë²„ê°€ ë³´ë‚¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
            throw new Error(data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
          }
          
        } catch (error) {
          console.error('Translation error:', error);
          this.showStatus(`ë²ˆì—­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`, 'error');
          this.outputText.value = ''; // ì˜¤ë¥˜ ë°œìƒ ì‹œ ì¶œë ¥ì°½ì„ ë¹„ì›ë‹ˆë‹¤.
        } finally {
          // ì„±ê³µí•˜ë“  ì‹¤íŒ¨í•˜ë“  ë§ˆì§€ë§‰ì— í•­ìƒ ë²„íŠ¼ì„ ë‹¤ì‹œ í™œì„±í™”í•©ë‹ˆë‹¤.
          this.translateBtn.disabled = false;
        }
      }
      
      // --- ìŒì•… ê´€ë ¨ ì½”ë“œëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ ---
      initializeMusic() {
        this.bgMusic.volume = 0.3;
        // ì‚¬ìš©ìì˜ ì²« ì¸í„°ë™ì…˜ ì‹œ ìŒì•…ì„ ì¬ìƒí•˜ê¸° ìœ„í•œ ì„¤ì •
        document.body.addEventListener('click', () => this.playMusic(), { once: true });
      }
      
      toggleMusic() {
        // ì´ë¯¸ ì¬ìƒ ì¤‘ì¸ì§€ë¥¼ musicBtnì„ í†µí•´ ì œì–´í•˜ì§€ ì•Šê³ , ì‹¤ì œ ì˜¤ë””ì˜¤ ìƒíƒœë¡œ ì œì–´í•©ë‹ˆë‹¤.
        if (this.bgMusic.paused) {
          this.playMusic();
        } else {
          this.pauseMusic();
        }
      }
      
      playMusic() {
        if (this.bgMusic.paused) {
           this.bgMusic.play().then(() => {
            this.musicBtn.textContent = 'ğŸµ';
            this.musicBtn.title = 'ë°°ê²½ìŒì•… ì¼ì‹œì •ì§€';
          }).catch(error => console.log('ìŒì•… ì¬ìƒ ì‹¤íŒ¨:', error));
        }
      }
      
      pauseMusic() {
        this.bgMusic.pause();
        this.musicBtn.textContent = 'ğŸ”‡';
        this.musicBtn.title = 'ë°°ê²½ìŒì•… ì¬ìƒ';
      }
    }
    
    // í˜ì´ì§€ ë¡œë”©ì´ ì™„ë£Œë˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
    document.addEventListener('DOMContentLoaded', () => {
      new KoreanEnglishTranslator();
    });
  </script>
</body>
</html>